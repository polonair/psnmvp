<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Bootstrap 101 Template</title>
        <link href="/bs337/css/bootstrap.min.css" rel="stylesheet">
        <link href="/xed/css/bootstrap-editable.css" rel="stylesheet">

        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>

    <body>
        <nav class="navbar navbar-default navbar-static-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">Project name</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="#" data-toggle="modal" data-target="#newLinkModal">Create link</a></li>
                        <li><a href="{{ path('logout') }}">Exit</a></li>
                    </ul>
                </div><!--/.nav-collapse -->
            </div>
        </nav>

        <div id="newLinkModal" class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">Share your profile</h4>
                    </div>
                    <div id="modalBodyForm" class="modal-body text-center">
                        <div class="form-inline">
                            <select id="activeFor" class="form-control">
                                <option value="1">Link will be active for 1 hour</option>
                                <option value="2">Link will be active for 1 day</option>
                                <option value="3">Link will be active for 1 week</option>
                                <option value="4">Link will be active forever</option>
                            </select>
                            <button class="btn btn-primary">Create</button>
                        </div>
                    </div>
                    <div id="modalBodySplash" class="modal-body text-center">
                        <p>Creating link, please, wait...</p>
                        <p><span class="glyphicon glyphicon-hourglass"></span></p>
                    </div>
                    <div id="modalBodyContent" class="modal-body text-center">
                        <p>Copy your link</p>
                        <code></code>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
                    </div>
                </div><!-- /.modal-content -->
            </div>
        </div>

        <div class="container">
            <h1>My profile</h1>

            <table class="table">
                <tr>
                    <td>Gender</td>
                    <td><a href="#" id="gender" data-title="Select gender"></a></td>
                </tr>
                <tr>
                    <td>Birthday</td>
                    <td><a href="#" id="birthday" data-title="Select date">{{ app.user.profile.birthday | date('Y.m.d') }}</a></td>
                </tr>
                <tr>
                    <td>Symptoms active</td>
                    <td><a href="#" id="activeSymptoms" data-title="Enter active symptoms">{{ app.user.profile.activeSymptoms }}</a></td>
                </tr>
                <tr>
                    <td>Symptoms past</td>
                    <td><a href="#" id="pastSymptoms" data-title="Enter symptoms past">{{ app.user.profile.pastSymptoms }}</a></td>
                </tr>
                <tr>
                    <td>Diagnosis Possible</td>
                    <td><a href="#" id="possibleDiagnosis" data-title="Enter diagnosis Possible">{{ app.user.profile.possibleDiagnosis }}</a></td>
                </tr>
                <tr>
                    <td>Diagnosis Active</td>
                    <td><a href="#" id="activeDiagnosis" data-title="Enter diagnosis Active">{{ app.user.profile.activeDiagnosis }}</a></td>
                </tr>
                <tr>
                    <td>Diagnosis Past</td>
                    <td><a href="#" id="pastDiagnosis" data-title="Enter diagnosis Past">{{ app.user.profile.pastDiagnosis }}</a></td>
                </tr>
                <tr>
                    <td>Medicaments Active</td>
                    <td><a href="#" id="activeMedicaments" data-title="Enter medicaments Active">{{ app.user.profile.activeMedicaments }}</a></td>
                </tr>
                <tr>
                    <td>Medicaments Past</td>
                    <td><a href="#" id="pastMedicaments" data-title="Enter medicaments Past">{{ app.user.profile.pastMedicaments }}</a></td>
                </tr>
                <tr>
                    <td>Hospitals</td>
                    <td><a href="#" id="hospitals" data-title="Enter hospitals">{{ app.user.profile.hospitals }}</a></td>
                </tr>
                <tr>
                    <td>Doctors</td>
                    <td><a href="#" id="doctors" data-title="Enter doctors">{{ app.user.profile.doctors }}</a></td>
                </tr>
                <tr>
                    <td>Procedures</td>
                    <td><a href="#" id="procedures" data-title="Enter procedures">{{ app.user.profile.procedures }}</a></td>
                </tr>
                <tr>
                    <td>Alternative medicine</td>
                    <td><a href="#" id="alternativeMedicine" data-title="Enter alternative medicine">{{ app.user.profile.alternativeMedicine }}</a></td>
                </tr>
                <tr>
                    <td>Supplement</td>
                    <td><a href="#" id="supplement" data-title="Enter supplement">{{ app.user.profile.supplement }}</a></td>
                </tr>
            </table>
        </div> <!-- /container -->

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="/bs337/js/bootstrap.min.js"></script>
        <script src="/xed/js/bootstrap-editable.js"></script>
        <script src="/xed/js/moment.min.js"></script>
        <script>
            $.fn.editable.defaults.mode = 'inline';
            $(document).ready(function() {
                $("#modalBodyForm button").click(function(){
                    $("#modalBodyForm").hide();
                    $("#modalBodySplash").show();
                    $("#modalBodyContent").hide();                  
                    $.ajax({url: "{{ path('createlink') }}", data: { d: $("#activeFor").val() }})
                    .done(function(msg){
                        $("#modalBodyContent>code").text(msg.link);
                        $("#modalBodyForm").hide();
                        $("#modalBodySplash").hide();
                        $("#modalBodyContent").show();
                    });
                });
                $('#newLinkModal').on('show.bs.modal', function (event) {
                    $("#modalBodyForm").show();
                    $("#modalBodySplash").hide();
                    $("#modalBodyContent").hide();
                });
                $('#gender').editable({
                    type: 'select',
                    pk: '{{ app.user.profile.id }}',
                    url: "{{ path('xed') }}",
                    value: {{app.user.profile.gender}},
                    source: [ {value: 1, text: 'unknown'}, {value: 2, text: 'female'}, {value: 3, text: 'male'} ]
                });
                $('#birthday').editable({
                    type: 'combodate',
                    pk: '{{ app.user.profile.id }}',
                    url: "{{ path('xed') }}",
                    format: 'YYYY-MM-DD',
                    template: 'D / MMM / YYYY'
                });

                var txt = { type: 'text', pk: '{{ app.user.profile.id }}', url: "{{ path('xed') }}" };
                $('#activeSymptoms').editable(txt);
                $('#pastSymptoms').editable(txt);
                $('#possibleDiagnosis').editable(txt);
                $('#activeDiagnosis').editable(txt);
                $('#pastDiagnosis').editable(txt);
                $('#activeMedicaments').editable(txt);
                $('#pastMedicaments').editable(txt);
                $('#hospitals').editable(txt);
                $('#doctors').editable(txt);
                $('#procedures').editable(txt);
                $('#alternativeMedicine').editable(txt);
                $('#supplement').editable(txt);
            });
        </script>
    </body>
</html>
